# 監査対象

Contracts フォルダ直下の以下ファイルが監査対象となります

### YamanekoSBT.sol

- NeoChampion に新規登録したユーザーに対して発行するキャラクター SBT
- 1 人のユーザーに対して 1 つの SBT を発行する（ただしコンテンツごとに 1 つ）
- SBT ＝転送できない NFT
- SBT は保有している折り紙 NFT に装填させることができる
- SBT が対象コンテンツでのユーザーのステータスとなる metadata はオフチェーンで管理する

### YamanekoNFT.sol

- JungleBet でのレースに参加するために必要な NFT
- 郵送された折り紙など物理的なアイテムから運営側で NFT として発行する
- ステータスとなる metadata はオフチェーンで管理する
- SBT を装填した NFT は転送できない（コントラクト上で転送できない仕様とする）
- SBT を装填した NFT のみマッチングに参加できる
- 分身 SBT が装填されているかどうかを取得可能とする
- ユーザーによる approve をガスレス（MATIC 運営負担）を実現するため、メタトランザクション方式を採用する

### YamanekoMarketplace.sol

- 折り紙 NFT の売買ができる
- Polygon チェーンの独自トークン での支払いができる
- ホルダーは JUGL を指定してリストすることができる（オフチェーン）
- ホルダー以外のユーザーはリストから選択して、NFT を購入できる
- NFT 購入時に支払いする独自トークンをマケプレ側で送金可能にするような署名を渡して支払いを成立させる
- クリエイターフィーが発生する
- プラットフォームフィーが発生する
- オファーやオークションといった機能はない（後から機能追加は可能）
- Yamaneko の NFT は Yamaneko マーケットプレイスのみで売買できる
- ユーザーによる購入トランザクションをガスレス（MATIC 運営負担）を実現するため、メタトランザクション方式を採用する

### JuglToken.sol

- 本サービスで発行する独自トークンのプロトタイプ
- とりあえずは ERC20Pausable,ERC20Permit と運営 mint のみ

# 監査で望むこと

- アクセスコントロールの権限周りが正しいか
- 想定しているシーケンスが成立しないようなリスクがないか
- 今後アップグレーダブルをする前提で何かリスクはないか
- マケプレでの独自トークンの扱いでリスクがないか
- 署名周りでセキュリティに関わるリスクがないか
- ガスレス設計でリスクや改善点がないか
- （可能であれば）消費ガスが減らせるコードはないか　※Assembly は使用しない前提

# その他情報

以下 4 つのコントラクトで構成される

1. 分身 SBT
2. 対戦 NFT
3. マーケットプレイス
4. 独自トークン

分身 SBT と対戦 NFT はコンテンツごとに管理される必要があるため、あらかじめ考慮した設計とする。
（今回の OrigamiDAO ではコンテンツ ID1 として扱う、今後コンテンツが増えた場合に別のコンテンツ ID を使用する）
また、今後仕様変更する必要がある可能性が高いため独自トークンいがいの 3 つは Upgradeable なコントラクトとする。

## 分身 SBT と対戦 NFT の関係

- 分身 SBT は各ユーザーに対して 1 つ発行される
- 分身 SBT は対戦 NFT に装填される
- 分身 SBT が装填されている対戦 NFT のみがマッチングに参加できる
- 分身 SBT が装填された対戦 NFT は転送できない
- 分身 SBT が装填された対戦 NFT はマーケットプレイスに出品できない
- 分身 SBT はマッチング参加中でなければいつでも他の対戦 NFT に装填しなおすことができる

## ガスレス設計について

- ユーザーは一切のガス代を支払う必要がない設計としている（運営ウォレットで負担）
- ユーザーはメタトランザクションを用いて、マーケットプレイスでの売買を行う

---

# How to use

This project demonstrates a basic Hardhat use case. It comes with a sample contract, a test for that contract, and a script that deploys that contract.

Try running some of the following tasks:

```shell
// 環境構築
npm install
// テスト
npx hardhat test
// デプロイ
npx hardhat run scripts/deploy.ts
```

### 注意

必ず env ファイルを作成してください

以下に CoinMarketCap の API キーを入れるとガス代見積もりができます
COINMARKETCAP_API_KEY
